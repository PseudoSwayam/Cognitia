[SOURCE]: data/raw_papers/Does_an_artificial_intelligence_perform_market_manipulation_with_its_own
__discr.pdf
[TYPE]: pdf
[DATE]: 2025-07-17_15-12-11

Does an articial intelligence perform market manipulation with its own discretion?  A genetic algorithm learns in an articial market simulation  Takanobu Mizuta SPARX Asset Management Co. Ltd., Tokyo, Japan Abstract Who should be charged with responsibility for an ar- ticial intelligence performing market manipulation have been discussed. In this study, I constructed an articial intelligence using a genetic algorithm that learns in an articial market simulation, and investi- gated whether the articial intelligence discovers mar- ket manipulation through learning with an articial market simulation despite a builder of articial intel- ligence has no intention of market manipulation. As a result, the articial intelligence discovered market manipulation as an optimal investment strategy. This result suggests necessity of regulation, such as obligat- ing builders of articial intelligence to prevent articial intelligence from performing market manipulation. 1 Introduction Who should be charged with responsibility for an arti- cial intelligence (AI) having an accident and/or per- forming an illegal action have been discussed. In nan- cial sector, who should be charged with responsibility for an AI performing market manipulation have been discussed. Market manipulation is that some traders articially increase or decrease market prices to gain their prots, and is prohibited in many countries as unfair trades. Scopino indicated that when a human has built an AI trader without intention to perform market manip- ulation and the AI trader has actually performed mar- ket manipulation with its own discretion, the human may not be charged with responsibility in the present regulation of the united states [1]. This means that even though market prices are manipulated no one is charged with responsibility. This is a big problem to mizutata@gmail.com, https://mizutatakanobu.com prevent keeping quality of markets. An AI trader must automatically learn impacts of its trades to market prices in order to discover that mar- ket manipulation earns prot because own trades must increase or decrease market prices to perform market manipulation. An AI trader is usually evaluated by backtesting, in which the prot is estimated if the AI trader were trading at some time using historical real data of market prices. An AI trader cannot learn im- pacts of its trades to market prices because market prices are xed as real historical data in the backtest- ing. Therefore, an AI trader will not discover that market manipulation earns prot when the AI trader use backtesting as learning process. Then, we do not have to worry that an AI trader performs market ma- nipulation with its own discretion without the humans intention as long as using backtesting. In contrast, an articial market simulation using a kind of agent-based model [2] allows an AI trader to be able to automatically learn impacts of its trades to market prices because in the simulation market prices are changed by trades of an AI trader. In this study, as Fig. 1 shown, I constructed an AI trader using a genetic algorithm 1 that learns in an articial market simulation, and investigated whether the AI trader discovers market manipulation through learning despite a builder of the AI trader has no in- tention of market manipulation. 1A genetic algorithm is a calculation method approximately searching an optimal solution inspired by the evolution of life by the force of natural selection. Input values are represent as genes, and surviving a gene that has higher adaptability (output value) leads to obtain an optimal solution, that is the input value that emerges the highest output value. Goldberg wrote the great text book [3] 1 arXiv:2005.10488v1 [q-fin.TR] 21 May 2020 Order Exchange Artificial Market Simulation Actions By a Gene Gene Genetic Algorithm All Actions Profit=Evaluation AI agent (AIA) Gene Artificial Market All Actions Evaluation Gene Gene                 B S S  B B S S  S S S S  B B B B  S Nt Actions(Buy(B), Sell(S), No action(null)) Ng Genes Inherit to new Generation after Crossover and Mutation Repeat Ne generations         Normal Agent (NA) Artificial Market Artificial Market All Actions Evaluation All Actions Evaluation Fig. 1: My model 2 Model A human building an AI trader (builder) gives the AI trader candidates of trading strategies, and makes the AI trader to learn which strategies and parameters earn more. This study focuses whether an AI trader can discover market manipulation through learning de- spite the builder has no intention of market manipula- tion2. Fig. 1 schematically shows a model of this study. An AI trader that the builder intents no trading strategy is modeled using a genetic algorithm in which a gene includes all trades. Each gene is evaluated in the arti- cial market simulation. The articial market includes an AI agent (AIA) that trades exactly same as one gene indicating. The gene is evaluated by AIAs prot 2In reality, the builder always intents some kinds of strate- gies in the process of picking up and modeling candidates of strategies. In contrast, it is very important for this study that the builder has no intention of any strategies including market manipulation. Therefore, I do not intentionally modeled trad- ing strategies and my model directly searches for all the best trades in an articial market environment. Due to no models of trading strategies my model can not make any outputs in an out-sample, then no one can test my model in an out-sample. I argue, however, that this study needs no evaluations in an out- sample because this study focuses whether an AI trader can dis- cover market manipulation through learning despite the builder has no intention of market manipulation. This study does not aim to use my model in actual nancial markets that are in an out-sample environment. in the articial market simulation. The genetic algo- rithm search the gene most earns prot. This searching corresponds with what the AI trader learns how trades earns prot. Of course, trades of the AIA impact market prices in the articial market, but for the purpose of compar- ison, I also investigated the case without the impacts to market prices (backtesting). In the following, at rst I explain the articial mar- ket simulation evaluating each gene and then, I explain the genetic algorithm searching the gene most earns prot. 2.1 Articial Market Simulation In this study, I built an articial market model added an AIA to the articial market model of Mizuta [2] In the model here, there is one stock. The stock exchange adopts a continuous double auction to de- termine the market price. In this auction mechanism, multiple buyers and sellers compete to buy and sell nancial assets in the market, and transactions can occur at any time whenever an oer to buy and an of- fer to sell match. The minimum unit of price change is P. The buy-order price is rounded oto the nearest fraction, and the sell-order price is rounded up to the nearest fraction. The model includes n normal agents (NAs) and an AIA. Agents can short sell freely. The quantity of hold- 2 ing positions is not limited, so agents can take any shares for both long and short positions to innity. Agents always places an order for only one share. I employed tick time t that increase by one when an agent orders. 2.1.1 Normal Agent (NA) To replicate the nature of price formation in actual nancial markets, I introduced the NA to model a very general investor. The number of NAs is n. First, at time t = 1, NA No. 1 places an order to buy or sell its risk asset; then, at t = 2, 3, , , n, NAs No. 2, 3, , , n respectively place buy or sell orders. At t = n + 1, the model returns to the rst NA and repeats this cycle. An NA determines an order price and buys or sells as follows. It uses a combination of a fundamental value and technical rules to form an expectation on a risk assets return. The expected return of agent j for each risk asset is rt e,j = (w1,j log Pf P t1 +w2,j log P t1 P tj1 +w3,jt j)/3 i wi,j (1) where wi,j is the weight of term i for agent j and is independently determined by random variables uni- formly distributed on the interval (0, wi,max) at the start of the simulation for each agent. log is natural logarithm. Pf is a fundamental value and is a con- stant. P t is a market price that is the mid price (the average price of the highest buy order price and the lowest sell order price), and t j is determined by ran- dom variables from a normal distribution with average 0 and variance . Finally, j is independently deter- mined by random variables uniformly distributed on the interval (1, max) at the start of the simulation for each agent3. The rst term of Eq. (1) represents a fundamental strategy: the NA expects a positive return when the market price is lower than the fundamental value, and vice versa. The second term of Eq. (1) represents a technical strategy using a historical return: the NA expects a positive return when the historical market return is positive, and vice versa. The third term of Eq. (1) represents noise. After the expected return has been determined, the expected price is P t e,j = P t exp (rt e,j). (2) An order price P t o,j is determined by random vari- ables uniformly distributed on the interval (P t e,j  Pd, P t e,j + Pd) where Pd is a constant. Whether to buy or sell is determined by the magnitude relation- ship between P t e,j and P t o,j: 3When t < j, however, the second term of Eq. (1) is zero. when P t e,j > P t o,j, the NA places an order to buy one share, but when P t e,j < P t o,j, the NA places an order to sell one share4. The remaining order is canceled after tc from the order time. 2.1.2 AI Agent (AIA) Every t tick time the AIA takes one of three actions that are buy one share (at the lowest sell order price on the order book), sell one share (at the highest buy order price on the order book) and no action5. The AIA takes actions Nt = (te tc)/t times through the whole one articial market simulation, where one simulation runs until tick time te. The actions are given by one gene in the genetic algorithm as following I will mention. 2.2 Genetic Algorithm 2.2.1 Genes and Articial Market Fig. 1 schematically shows a model of this study. An AI trader that the builder intents no trading strategy is modeled using a genetic algorithm. The number of genes is Ng. One gene has information of actions and the number of actions that one gene has is Nt. Each action is one of three actions that are buy one share, sell one share and no action. Each gene is evaluated by prot of the AIA in an articial market, in where the AIA trades every t tick time same as Nt actions one gene indicating. When the AIA holds stocks at the end of a simulation, the stocks are evaluated as Pf. All articial markets has exactly same NAs using same random numbers. Therefore, if the AIA trades same, the articial markets output same market prices and same NAs trades. 2.2.2 Inheritance to Next Generation The top Nge genes that earned most are not changed and inherited to the next generation. Non top Nge genes are, with a probability of Rc, re- placed to the crossed-over gene with two genes g0 and g1 that are randomly selected from the top Nge genes. In the crossover, rst, all actions are replace with those of the gene g0, and then from i0th to i1th actions (i0 and i1 are randomly determined) are replaced with those of the gene g1. After crossovers, each action of 4When t < tc, however, to generate enough waiting orders, the agent places an order to buy one share when Pf > P t o,j, or to sell one share when Pf < P t o,j. 5But, the AIA dose not take any action before tick time tc to stabilize the simulations. As I mentioned at *4, the period before tc is aimed to generate enough waiting orders. 3 9800 10000 10200 10400 10600 0 1000 2000 3000 4000 5000 6000 7000 Price Tick Time with AIA without AIA Fig. 2: Time evolution of market prices (mid prices) in the case with the AI agent (AIA) and without the AIA all the non top Nge genes is mutated with a probabil- ity of Rm. The mutated action is changed with same probability to buy, sell or no action. This inheritance to the next generation is repeated Ne times. At the rst generation, all actions of all genes are determined with same probability to buy, sell or no action. 3 Simulation Result In this study, I set parameters for the articial market with n = 900, w1,max = 1, w2,max = 100, w3,max = 1, max = 1000,  = 0.03, Pd = 1000, tc = 2000, P = 0.01, Pf = 10000, t = 10. I ran simulations to t = te = 10000. I set parameters for the genetic algorithm with Nt = (te tc)/t = 800, Ng = 10000, Nge = 400, Rc = 0.65, Rm = 0.2, Ne = 1500. These lead Ng  Ne = 1.5  107, this means that I have executed 15 million simulation runs of the articial market. In the following result, I used the AIA of the best gene at the nal generation. 3.1 Result of First Simulation Run Fig. 2 shows the time evolution of market prices (mid prices) in the case with the AIA and without the AIA. The AIA amplied variation of market prices. Fig. 3 shows the time evolution of market prices with the AIA and trading volume (positive and neg- ative number show buy and sell, respectively) aggre- gated within each 200 tick time. Around 2000 tick time, the AIA bought many stocks, and this buying leads to the market prices increasing. Around 3000 tick time, the market prices continued to increase even though the AIA did not bought so many stocks. Here, the fundamental strategy of normal agents in the rst term of Eq. (1) expected negative return because the market prices are over the fundamental price. On the other hand, the technical strategy in the second term of Eq. (1) expected larger positive return due to the his- torical positive return around 2000 tick time where the AIA had increased market prices by itself. Therefore, the market prices were able to increase even though the AIA did not bought so many stocks. After then, from around 4000 tick time to around 6000 tick time, the AIA was able to sell stocks with higher prices than the prices bought them around 2000 tick time thanks to increasing market prices around 3000 tick time. These trades of the AIA are nothing but market ma- nipulation. This indicates that an articial intelligence can discover market manipulation as an optimal in- vestment strategy through learning with an articial market simulation. Fig. 4 shows the time evolution of market prices and trading volume in the case without the impacts to market prices (backtesting) like Fig. 3. Note that Fig. 4 has dierent scale for the vertical axis from those in Fig. 2 and Fig. 3. The time evolution of market prices is exactly same as the case without the AIA because the trades of the AIA never impact market prices in Fig. 2. Due to lower market prices from the funda- mental price, the AIA tended to buy stocks. These trades of the AIA corresponds to fundamental strat- egy. Thus, in the case of backtesting, the AIA cannot discover market manipulation as trading strategy. This indicates possibility that an articial intelli- gence cannot discover market manipulation through learning with backtesting. 4 Summary and Future Works In this study, as Fig. 1 shown, I constructed an AI trader using a genetic algorithm that learns in an ar- ticial market simulation, and investigated whether the AI trader discovers market manipulation through learning despite a builder of the AI trader has no in- tention of market manipulation. As a result, the AI trader discovered market ma- nipulation as an optimal investment strategy. This indicates that despite a builder of the AI trader has no intention of market manipulation, the AI trader can discover market manipulation as an optimal in- vestment strategy through learning with an articial market simulation in which the AI trader to be able to automatically learn impacts of its trades to market prices. On the other hand, this also indicates possi- bility that an AI trader cannot discover market ma- nipulation through learning with backtesting in which there are no impacts to market prices. 4 -20 0 20 40 60 9800 10000 10200 10400 10600 0 1000 2000 3000 4000 5000 6000 7000 Trading Volume Price Tick Time Trading Volume of AIA (right) Market Price (left) Fundamental Price (left) Fig. 3: Time evolution of market prices with the AIA and trading volume (positive and negative number show buy and sell, respectively) aggregated within each 200 tick time -20 0 20 40 60 9980 10000 10020 10040 10060 0 1000 2000 3000 4000 5000 6000 7000 Trading Volume Price Tick Time Trading Volume of AIA (right) Market Price (left) Fundamental Price (left) Fig. 4: Case without the impacts to market prices (backtesting) This result suggests necessity of regulation, such as obligating builders of articial intelligence to prevent articial intelligence from performing market manipu- lation. Of course, future works exist. In this study, I sim- ulated eleven situations by one data set of normal agents. In short, I simulated whole my model showed Table 1: Statistics for Returns in the Articial Market standard deviation of returns 0.0103% kurtosis of returns 11.54 lag 1 0.081 auto-correlation 2 0.041 coecient of 3 0.032 square returns 4 0.047 5 0.018 by Fig. 1 only one time. Because this study aimed to investigate whether possibility that an articial intel- ligence discovers market manipulation exists or does not, the only one simulation run indicating the pos- sibility is enough for the aim of this study. On the discussing necessity of regulation, whether there is the possibility or not is very important. On the other hand, how easily an articial intelligence can discover market manipulation may also interested. To answer the question, whole my model should be simulated more times. The many runs needs very faster com- puters. This is one of future works. 5 Appendix 4.1 Verication of the Articial Mar- ket Model In many previous articial market studies, the mod- els were veried to see whether they could explain stylized facts, such as a fat-tail or volatility-clustering [2, 4, 5]. A fat-tail means that the kurtosis of price returns is positive. Volatility-clustering means that square returns have a positive auto-correlation, and this auto-correlation slowly decays as its lag becomes longer. Many empirical studies, e.g., that of Sewell [6], have shown that both stylized facts (fat-tail and volatility-clustering) exist statistically in almost all - nancial markets. Conversely, they also have shown that only the fat-tail and volatility-clustering are sta- bly observed for any asset and in any period because nancial markets are generally unstable. Indeed, the kurtosis of price returns and the auto- correlation of square returns are stably and signi- cantly positive, but the magnitudes of these values are unstable and very dierent depending on the as- set and/or period. The kurtosis of price returns and the auto-correlation of square returns were observed to have very broad magnitudes of about 1 100 and about 0 0.2, respectively [6]. For the above reasons, an articial market model should replicate these values as signicantly positive and within a reasonable range as I mentioned. It is not essential for the model to replicate specic values of stylized facts because the values of these facts are unstable in actual nancial markets. Table 1 lists the statistics, standard deviation of re- turns, kurtosis of price returns, and auto-correlation coecient of square returns, where the returns are measured within 100 time steps and the statistics are averaged values of the 100 simulation runs. This table shows that this model replicated the statistical char- acteristics, fat-tails, and volatility-clustering observed in real nancial markets. Disclaimer Note that the opinions contained herein are solely those of the authors and do not necessarily reect those of SPARX Asset Management Co., Ltd. Reference [1] G. Scopino, Do automated trading systems dream of manipulating the price of futures contracts? policing markets for improper trading practices by algorithmic robots, Florida Law Review, vol. 67, p. 221, 2016. [Online]. Available: https://scholarship.law.u.edu/r/vol67/iss1/5 [2] T. Mizuta, An agent-based model for designing a nancial market that works well, arXiv, 2019. [Online]. Available: https://arxiv.org/abs/1906.06000 [3] D. E. Goldberg, Genetic Algorithms in Search, Optimiza- tion, and Machine Learning. Addison-Wesley Professional, 1989. [4] B. LeBaron, Agent-based computational nance, Hand- book of computational economics, vol. 2, pp. 1187 1233, 2006. [Online]. Available: https://doi.org/10.1016/ S1574-0021(05)02024-1 [5] S.-H. Chen, C.-L. Chang, and Y.-R. Du, Agent-based economic models and econometrics, Knowledge Engineer- ing Review, vol. 27, no. 2, pp. 187219, 2012. [Online]. Available: https://doi.org/10.1017/S0269888912000136 [6] M. Sewell, Characterization of nancial time series, Research Note, University College London, Department of Computer Science, no. RN/11/01, 2011. [Online]. Available: https://nance.martinsewell.com/stylized-facts/ 6